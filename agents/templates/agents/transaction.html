
{% extends 'agents/base.html' %}
{% load static %}

{% block title %}Détails de la transaction{% endblock %}

{% block content %}

<div class="row mt-5 mt-0 mb-5 justify-content-center">
  <div class="card bg-white col-11 col-md-6">
    <div class="card-header bg-white">
      <h2 class="text-center fw-bolder bg-white">Détails de la Transaction</h2>
    </div>
    <div class="card-body">
      {% if transaction %}
        <h3 class="text-center">
          {% if transaction.type == 'retrait' %}Retrait d'argent
          {% elif transaction.type == 'transfert' %}Transfert d'argent
          {% elif transaction.type == 'depot_objectif' %}Dépôt sur objectif
          {% elif transaction.type == 'depot_inscription' %}Dépôt d'inscription
          {% elif transaction.type == 'contribution' %}Contribution mensuelle
          {% elif transaction.type == 'pret' %}Prêt d'argent
          {% elif transaction.type == 'remboursement_pret' %}Remboursement de pret
          {% elif transaction.type == 'retrait_objectif' %}Retrait d'objectif
          {% elif transaction.type == 'retrait_admin' %}Retrait Admin
          {% elif transaction.type == 'retrait_tout' %}Retrait total
          {% elif transaction.type == 'annulation_objectif' %}Annulation Objectif
          {% else %}{{ transaction.type }}
          {% endif %}
        </h3>

        <dl class="row justify-content-center">
          <dt class="col-5">Montant</dt>
          <dd class="col-6">{{ transaction.montant|stringformat:".2f" }} {{ transaction.devise }}</dd>  <!-- Format amount -->

          <dt class="col-5">Date</dt>
          <dd class="col-6">{{ transaction.date|date:"d/m/Y H:i" }}</dd>  <!-- Format date and time -->

          <dt class="col-5">Utilisateur</dt>
          <dd class="col-6">{{ transaction.membre }}</dd>

          {% if transaction.type == 'transfert' and transaction.destinataire %} <!-- Check if destinataire exists -->
            <dt class="col-5">Destinataire</dt>
            <dd class="col-6">{{ transaction.destinataire.username }}</dd>
          {% endif %}

          {% if transaction.type == 'pret' %}
            <dt class="col-5">Taux d'intérêt</dt>
            <dd class="col-6">10%</dd>

            <dt class="col-5">Montant à rembourser</dt>
            <dd class="col-6">{{ transaction.pret.montant_remboursé }}</dd>

            <dt class="col-5">Date de fin</dt>
            <dd class="col-6">{{ transaction.pret.date_remboursement|date:"d/m/Y H:i" }}</dd>
          {% endif %}

          {% if transaction.preuve %}
            <dt class="text-center">Preuve de la transaction</dt>
            <dd class="text-center">
              <a href="{{ transaction.preuve.url }}" target="_blank" rel="noopener noreferrer">
                <img src="{{ transaction.preuve.url }}" alt="Preuve de transaction" style="max-width: 200px;">
              </a>
            </dd>
          {% endif %}
        </dl>
      {% else %}
        <p>Aucune transaction trouvée.</p>
      {% endif %}
        <div class="text-center">
            <button class="btn btn-secondary" onclick="window.history.back()">Retour</button>  <!-- Corrected link -->
        </div>
    </div>
  </div>
</div>

{% endblock %}
